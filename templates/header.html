{% load static %}
<div class="header-top-strip">
  <div class="container">
    <div class="header-top-left">
      <p><a href="support.html">24/7 Customer Care</a> | <a class="play-icon popup-with-zoom-anim"
          href="#small-dialog" href="#"> Resend Booking Confirmation</a> </p>
      <div id="small-dialog" class="mfp-hide">
        <div class="select-city">
          <h3>Resend Confirmation</h3>
          <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry</p>
          <div class="confirmation">
            <form>
              <input type="text" class="email" placeholder="Email" required="required"
                pattern="([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?" title="Enter a valid email" />
              <input type="text" class="email" placeholder="Mobile Number" maxlength="10"
                pattern="[1-9]{1}\d{9}" title="Enter a valid mobile number" />
              <input type="submit" value="SEND">
            </form>
          </div>
          <div class="clearfix"></div>
        </div>
      </div>
    </div>
    <div class="header-top-right">
      <div class="modal fade">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                  aria-hidden="true">&times;</span></button>
              <h4 class="modal-title">Modal title</h4>
            </div>
            <div class="modal-body">
              <p>One fine body&hellip;</p>
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
              <button type="button" class="btn btn-primary">Save changes</button>
            </div>
          </div><!-- /.modal-content -->
        </div><!-- /.modal-dialog -->
      </div><!-- /.modal -->
      <!-- Button trigger modal  -->
      <!---pop-up-box---->
      <link href={% static "css/popuo-box.css" %} rel="stylesheet" type="text/css" media="all" />
      <script src={% static "js/jquery.magnific-popup.js" %} type="text/javascript"></script>
      <!---//pop-up-box---->
    
      <script>
        $(document).ready(function () {
          $('.popup-with-zoom-anim').magnificPopup({
            type: 'inline',
            fixedContentPos: false,
            fixedBgPos: true,
            overflowY: 'auto',
            closeBtnInside: true,
            preloader: false,
            midClick: true,
            removalDelay: 300,
            mainClass: 'my-mfp-zoom-in'
          });

        });
      </script>
      <!-- Large modal -->
       {% if not user.is_authenticated %}
       <button class="btn btn-primary" data-toggle="modal" data-target="#myModal">
         Login</button>
       {% endif %}
      <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel"
        aria-hidden="true">
        <div class="modal-dialog modal-lg">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                &times;</button>
              <h4 class="modal-title" id="myModalLabel">
                Don't Wait, Login now!</h4>
            </div>
            <div class="modal-body">
              <div class="row">
                <div class="col-md-8" style="border-right: 1px dotted #C2C2C2;padding-right: 30px;">
                  <!-- Nav tabs -->
                  <ul class="nav nav-tabs">
                    <li class="active"><a href="#Login" data-toggle="tab">Login <font color='red'>
                          </font></a></li>
                    <li><a href="#Registration" data-toggle="tab">Registration <font color='green'>
                          </font>
                        <font color='red'></font>
                      </a></li>
                  </ul>
                  <!-- Tab panes -->
                  <div class="tab-content">
                    <div class="tab-pane active" id="Login">
                      {% if messages %}
                        {% for message in messages %}
                          <div class="alert alert-danger">{{ message }}</div>
                        {% endfor %}
                      {% endif %}
                      <form role="form" class="form-horizontal" action="{% url "user:login" %}" method="post">
                        {% csrf_token %}
                        <div class="form-group">
                          <label for="email" class="col-sm-2 control-label">
                            Email</label>
                          <div class="col-sm-10">
                            <input type="email" class="form-control" id="email1" placeholder="Email"
                              name="email" required />
                          </div>
                        </div>
                        <div class="form-group">
                          <label for="exampleInputPassword1" class="col-sm-2 control-label">
                            Password</label>
                          <div class="col-sm-10">
                            <input type="password" class="form-control" id="exampleInputPassword1"
                              placeholder="password" name="password" required />
                          </div>
                        </div>
                        <div class="row">
                          <div class="col-sm-2">
                          </div>
                          <div class="col-sm-10">
                            <button type="submit" class="btn btn-primary btn-sm">
                              Submit</button>
                            <a href="{% url "password_reset" %}">Forgot your password?</a>
                          </div>
                        </div>
                      </form>
                    </div>
                    <div class="tab-pane" id="Registration">
                      <form id="registrationForm" role="form" class="form-horizontal" method="post">
                        {% csrf_token %}
                        <div class="form-group">
                          <label for="name" class="col-sm-2 control-label">Name</label>
                          <div class="col-sm-10">
                            <input type="text" class="form-control" placeholder="Name" id="name" name="first_name" />
                            <div class="error" id="error_first_name"></div> <!-- Error container -->
                          </div>
                        </div>
                    
                        <div class="form-group">
                          <label for="username" class="col-sm-2 control-label">Username</label>
                          <div class="col-sm-10">
                            <input type="text" class="form-control" placeholder="Username" id="username" name="username" />
                            <div class="error" id="error_username"></div> <!-- Error container -->
                          </div>
                        </div>
                    
                        <div class="form-group">
                          <label for="email" class="col-sm-2 control-label">Email</label>
                          <div class="col-sm-10">
                            <input type="email" class="form-control" id="email" placeholder="Email" name="email" />
                            <div class="error" id="error_email"></div> <!-- Error container -->
                          </div>
                        </div>
                    
                        <div class="form-group">
                          <label for="password" class="col-sm-2 control-label">Password</label>
                          <div class="col-sm-10">
                            <input type="password" class="form-control" id="password1" placeholder="Password" name="password1" />
                            <div class="error" id="error_password1"></div> <!-- Error container -->
                          </div>
                        </div>
                    
                        <div class="row">
                          <div class="col-sm-2"></div>
                          <div class="col-sm-10">
                            <button type="submit" class="btn btn-primary btn-sm">Save & Continue</button>
                            <input type="reset" class="btn btn-primary btn-sm" value="Cancel">
                          </div>
                        </div>
                      </form>
                    </div>
                    
                    <script>
                    document.getElementById('registrationForm').addEventListener('submit', function(e) {
                        e.preventDefault();  // Prevent default form submission
                    
                        let formData = new FormData(this);  // Collect form data
                        let csrfToken = "{{ csrf_token }}";  // Pass CSRF token
                    
                        fetch("{% url 'user:register' %}", {
                            method: 'POST',
                            headers: {
                                'X-CSRFToken': csrfToken
                            },
                            body: formData
                        })
                        .then(response => response.json())
                        .then(data => {
                            if (data.success) {
                                alert("Registration successful!");
                                // Redirect to home or login page
                                window.location.href = "{% url 'user:home' %}";
                            } else {
                                // Handle validation errors
                                Object.keys(data.errors).forEach(function(key) {
                                    let errorElement = document.getElementById('error_' + key);
                                    if (errorElement) {
                                        errorElement.innerHTML = data.errors[key][0];  // Display the first error
                                    }
                                });
                            }
                        })
                        .catch(error => console.error('Error:', error));
                    });
                    </script>
                    
                  </div>
                  <div id="OR" class="hidden-xs">
                    OR</div>
                </div>
                <div class="col-md-4">
                  <div class="row text-center sign-with">
                    <div class="col-md-12">
                      <h3 class="other-nw">
                        Sign in with</h3>
                    </div>
                    <div class="col-md-12">
                      <div class="btn-group btn-group-justified">
                        <a href="https://www.facebook.com" class="btn btn-primary">Facebook</a> <a
                          href="https://www.google.com" class="btn btn-danger">
                          Google +</a>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="clearfix"></div>
  </div>
</div>

